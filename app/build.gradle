apply plugin: "com.android.application"


def enableHermes = false

dependencies {
    fileTree(dir: "libs", include: ["*.jar"])
    api 'androidx.appcompat:appcompat:1.1.0'
    api 'androidx.recyclerview:recyclerview:1.1.0'
    api 'androidx.swiperefreshlayout:swiperefreshlayout:1.0.0'
    api 'com.google.android.material:material:1.1.0'

    api project(path: ':libreacthotfix')
    api project(path: ':web')
    api 'com.zhy:okhttputils:2.6.2'
    api 'com.google.code.gson:gson:2.8.5'
    api "com.facebook.react:react-native:0.62.2" // From node_modules

    if (enableHermes) {
        def hermesPath = "C:/reactnative/AwesomeProject/node_modules/hermes-engine/android/";
        debugImplementation files(hermesPath + "hermes-debug.aar")
        releaseImplementation files(hermesPath + "hermes-release.aar")
    } else {
        implementation "org.webkit:android-jsc:+"
    }
}

android {
    compileSdkVersion 28

    def currentVersionCode = getVersionCode()
    def currentVersionName = getVersionName()

    defaultConfig {
        applicationId "com.supet.react"
        minSdkVersion 16
        targetSdkVersion 28
        versionCode currentVersionCode
        versionName currentVersionName
    }

    sourceSets {
        debug.setRoot('build-types/debug')
        release.setRoot('build-types/release')
    }

    buildTypes {
        release {
            proguardFiles getDefaultProguardFile("proguard-android.txt"), "proguard-rules.pro"
        }
    }
    flavorDimensions "env"
    productFlavors {
        localhost {}
    }

}


def getVersionCode() {
    def versionFile = file('version.properties')

    if (versionFile.exists()) {
        def Properties versionProps = new Properties()
        versionProps.load(new FileInputStream(versionFile))
        def versionCode = versionProps['build.number'].toInteger()
        println('Current version code is ' + versionCode.toString())
        return versionCode
    } else {
        //throw new GradleException("Could not find version.properties!")
    }
}

def getVersionName() {
    def versionFile = file('version.properties')

    if (versionFile.exists()) {
        def Properties versionProps = new Properties()
        versionProps.load(new FileInputStream(versionFile))
        def versionCode = versionProps['build.versionName'].toString()
        println('Current version code is ' + versionCode.toString())
        return versionCode
    } else {
        //throw new GradleException("Could not find version.properties!")
    }
}
